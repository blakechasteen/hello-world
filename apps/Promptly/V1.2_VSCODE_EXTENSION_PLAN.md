# Promptly v1.2 - VS Code Extension Plan

**Target Release**: v1.2
**Timeline**: 4 weeks
**Tech Stack**: TypeScript, VS Code Extension API, React (for webviews)
**Status**: Planning Phase

---

## 🎯 Executive Summary

Build a VS Code extension that brings Promptly's **35+ tools** directly into the IDE, enabling developers to manage prompts, execute workflows, and analyze quality without leaving their editor.

**Strategic Impact**:
- Seamless workflow integration
- Discoverability (VS Code Marketplace)
- New user segment (IDE-first developers)
- Differentiation from CLI/MCP-only tools

---

## 🚀 Core Features (Must-Have)

### 1. Sidebar: Prompt Library Browser
**UI**: Tree View in Activity Bar
**Functionality**:
- Browse all prompts hierarchically
- Group by: branch, tags, recency
- Search/filter prompts
- Quick preview on hover
- Click to open in editor

**Commands**:
- Refresh library
- Create new prompt
- Switch branch
- Filter by tag

### 2. Prompt Editor Panel
**UI**: Custom Editor for `.promptly` files
**Functionality**:
- Syntax highlighting for prompt templates
- Variable placeholder completion
- Real-time quality scoring (inline)
- Metadata editing (tags, version)
- Git status indicator

**Features**:
- Auto-save on edit
- Version history navigation
- Diff view for changes

### 3. Quick Execute Panel
**UI**: Webview Panel (bottom panel)
**Functionality**:
- Select prompt from dropdown
- Fill in variables (form UI)
- Choose backend (Ollama, Claude API)
- Execute and show results
- Copy to clipboard
- Save to workspace

### 4. Command Palette Integration
**Commands** (20+):
- `Promptly: Create Prompt`
- `Promptly: Execute Prompt`
- `Promptly: Switch Branch`
- `Promptly: Show Analytics`
- `Promptly: Auto-Score Current Prompt`
- `Promptly: Find Related Prompts`
- `Promptly: Detect Duplicates`
- `Promptly: Health Check`
- `Promptly: Export Package`
- `Promptly: Import Package`

### 5. Analytics Dashboard
**UI**: Webview Panel (tab)
**Functionality**:
- Execution stats (charts)
- Top performing prompts
- Quality trends over time
- Cost tracking
- Recommendations

**Visualizations**:
- D3.js charts for trends
- Heatmaps for usage patterns
- Quality score distributions

---

## 🎨 UI/UX Design

### Layout
```
┌─────────────────────────────────────────────────────────┐
│ Activity Bar  │  Sidebar: Prompt Library                │
│               │  ┌───────────────────────────┐          │
│  📝 Promptly  │  │ 🔍 Search...              │          │
│               │  ├───────────────────────────┤          │
│               │  │ 📁 main                    │          │
│               │  │   ├─ SQL Optimizer (v3)   │          │
│               │  │   ├─ Code Reviewer (v2)   │          │
│               │  │   └─ Data Analyzer (v1)   │          │
│               │  │ 📁 feature/new-prompts    │          │
│               │  │   └─ Experiment1 (v1)     │          │
│               │  └───────────────────────────┘          │
│               │                                          │
├───────────────┴──────────────────────────────────────────┤
│  Editor: SQL Optimizer.promptly                         │
│  ┌────────────────────────────────────────────────────┐ │
│  │ Analyze this SQL query: {query}                    │ │
│  │                                                     │ │
│  │ Suggest optimizations for:                         │ │
│  │ - Performance                                      │ │
│  │ - Readability                                      │ │
│  │ - Best practices                                   │ │
│  │                                                     │ │
│  │ Quality Score: 0.87 ✓ (inline annotation)         │ │
│  └────────────────────────────────────────────────────┘ │
│                                                          │
├──────────────────────────────────────────────────────────┤
│  Bottom Panel: Quick Execute │ Analytics │ Output       │
│  ┌────────────────────────────────────────────────────┐ │
│  │ Prompt: SQL Optimizer ▼                            │ │
│  │ query: SELECT * FROM users WHERE active=1          │ │
│  │ Backend: Ollama (llama3.2:3b) ▼                    │ │
│  │                                                     │ │
│  │ [Execute] [Save Result] [Copy]                     │ │
│  └────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────┘
```

### Color Scheme
- Adapts to VS Code theme (light/dark)
- Accent color: Promptly brand color
- Status indicators: green (✓), yellow (⚠), red (✗)

### Icons
- Custom icon set for Promptly actions
- Codicons for standard VS Code actions

---

## 🏗️ Technical Architecture

### Project Structure
```
promptly-vscode/
├── src/
│   ├── extension.ts          # Main extension entry
│   ├── promptLibrary/
│   │   ├── promptTreeProvider.ts
│   │   ├── promptItem.ts
│   │   └── promptCommands.ts
│   ├── editor/
│   │   ├── promptEditorProvider.ts
│   │   ├── qualityScorer.ts
│   │   └── syntax.ts
│   ├── panels/
│   │   ├── executePanel.ts
│   │   ├── analyticsPanel.ts
│   │   └── healthPanel.ts
│   ├── api/
│   │   ├── promptlyClient.ts  # Python bridge
│   │   └── types.ts
│   └── utils/
│       ├── gitIntegration.ts
│       └── config.ts
├── webviews/
│   ├── execute/
│   │   ├── ExecutePanel.tsx   # React component
│   │   └── styles.css
│   ├── analytics/
│   │   ├── AnalyticsDashboard.tsx
│   │   ├── charts.tsx
│   │   └── styles.css
│   └── shared/
│       └── components/
├── media/
│   ├── icons/
│   └── styles/
├── package.json              # Extension manifest
├── tsconfig.json
└── README.md
```

### Communication with Promptly Python Backend

**Option 1: Python Bridge via Child Process**
```typescript
// Spawn Python process and communicate via stdio
const pythonBridge = spawn('python', ['-m', 'promptly.vscode_bridge']);
```

**Option 2: HTTP API Server**
```typescript
// Start lightweight FastAPI server in background
// Extension communicates via HTTP
const api = new PromptlyClient('http://localhost:8765');
```

**Recommendation**: **Option 2** - More robust, better error handling, easier debugging

### State Management
- VS Code Memento API for settings
- Global state for session data
- Context keys for command enablement

### Security
- API keys stored in VS Code secrets
- Sandboxed webviews with CSP
- Input validation for all user input

---

## 📦 Extension Capabilities

### Activation Events
```json
{
  "activationEvents": [
    "onView:promptly.promptLibrary",
    "onCommand:promptly.createPrompt",
    "onLanguage:promptly",
    "workspaceContains:**/.promptly/**"
  ]
}
```

### Contributed Views
```json
{
  "views": {
    "promptly-sidebar": [
      {
        "id": "promptly.promptLibrary",
        "name": "Prompt Library"
      }
    ]
  }
}
```

### Contributed Commands
```json
{
  "commands": [
    {
      "command": "promptly.createPrompt",
      "title": "Create Prompt",
      "category": "Promptly"
    },
    {
      "command": "promptly.executePrompt",
      "title": "Execute Prompt",
      "category": "Promptly"
    },
    // ... 18+ more commands
  ]
}
```

### File Associations
```json
{
  "languages": [
    {
      "id": "promptly",
      "extensions": [".promptly"],
      "aliases": ["Promptly Template"]
    }
  ]
}
```

---

## 🎯 Feature Breakdown by Week

### Week 1: Foundation
**Goal**: Basic extension skeleton + sidebar

**Tasks**:
- [x] Research complete
- [ ] Setup TypeScript project with VS Code Extension Generator
- [ ] Implement Activity Bar icon
- [ ] Build Prompt Library Tree View
  - Display prompts from `~/.promptly/prompts/`
  - Group by branch
  - Search/filter functionality
- [ ] Basic command palette integration
  - Create, refresh, switch branch
- [ ] Python bridge implementation (FastAPI server)
  - `/prompts` - List prompts
  - `/prompts/:name` - Get prompt
  - `/execute` - Execute prompt

**Deliverable**: Working sidebar that displays prompts

### Week 2: Editor + Execute
**Goal**: Edit prompts in VS Code + quick execution

**Tasks**:
- [ ] Custom editor for `.promptly` files
  - Syntax highlighting (TextMate grammar)
  - Variable placeholder IntelliSense
  - Metadata front-matter support
- [ ] Quality scoring integration
  - Inline annotations via Diagnostics API
  - Code actions for improvements
- [ ] Quick Execute webview panel
  - React UI for variable input
  - Backend selection dropdown
  - Execute button with loading state
  - Result display with formatting

**Deliverable**: Edit and execute prompts from VS Code

### Week 3: Analytics + Advanced Features
**Goal**: Analytics dashboard + Week 2 smart features

**Tasks**:
- [ ] Analytics Dashboard webview
  - D3.js charts for trends
  - Top prompts table
  - Cost tracking visualization
- [ ] Integrate Week 2 smart features
  - Auto-score command
  - Find related prompts
  - Detect duplicates
  - Health check status bar
- [ ] Git integration
  - Status indicators in tree view
  - Diff view for changes
  - Commit from extension

**Deliverable**: Full analytics + smart features

### Week 4: Polish + Marketplace
**Goal**: Polish, testing, publish to marketplace

**Tasks**:
- [ ] Comprehensive testing
  - Unit tests (Mocha)
  - Integration tests
  - Manual QA
- [ ] Documentation
  - README with screenshots
  - Usage guide
  - Marketplace description
- [ ] Performance optimization
  - Lazy loading
  - Caching
  - Bundle size reduction
- [ ] Package and publish
  - Generate .vsix
  - Publish to VS Code Marketplace
  - Create GitHub release

**Deliverable**: v1.2 released on VS Code Marketplace

---

## 🛠️ Development Setup

### Prerequisites
- Node.js 18+
- VS Code 1.85+
- Python 3.10+ (for backend)
- Promptly CLI installed

### Local Development
```bash
# Clone extension repo
git clone <promptly-vscode-repo>
cd promptly-vscode

# Install dependencies
npm install

# Start development
npm run watch

# Test in Extension Development Host
F5 (in VS Code)

# Start Python bridge (separate terminal)
cd Promptly/promptly
python -m promptly.vscode_bridge
```

### Testing
```bash
# Run unit tests
npm test

# Run integration tests
npm run test:integration

# Package extension
vsce package
```

---

## 📊 Success Metrics

### Technical
- Extension size < 5MB
- Activation time < 500ms
- Tree view renders < 100ms for 100 prompts
- Execute command completes < 5s for typical prompt

### User Adoption
- 1,000+ downloads in first month
- 4+ stars on Marketplace
- 10+ user reviews
- Low uninstall rate

### Business
- 30% of Promptly users adopt VS Code extension
- 50% increase in prompt executions (easier access)
- Reduced time-to-execute by 80% (vs CLI)

---

## 🚧 Technical Challenges & Solutions

### Challenge 1: Python Backend Communication
**Problem**: Need to communicate with Python Promptly backend
**Solution**: Lightweight FastAPI server started on-demand, communicates via HTTP

### Challenge 2: Large Prompt Libraries
**Problem**: Slow tree view rendering for 1000+ prompts
**Solution**: Virtual scrolling, lazy loading, pagination

### Challenge 3: Real-time Quality Scoring
**Problem**: Don't want to block editor with scoring
**Solution**: Debounced async scoring, cached results, Web Workers

### Challenge 4: Analytics Chart Performance
**Problem**: D3.js can be heavy, slow webview load
**Solution**: Canvas-based rendering, data aggregation on backend, lazy loading

### Challenge 5: Cross-Platform Compatibility
**Problem**: Windows, macOS, Linux all have different paths/behaviors
**Solution**: Path normalization, platform detection, extensive testing

---

## 🎨 Design Mockups

### Prompt Library Sidebar
```
┌─────────────────────────────┐
│ PROMPTLY                    │
├─────────────────────────────┤
│ 🔍 Search prompts...        │
├─────────────────────────────┤
│ ⚙️  Settings   🔄 Refresh   │
├─────────────────────────────┤
│                             │
│ 📁 main (12)                │
│   ├─ 📝 SQL Optimizer       │
│   │   v3 | ⭐ 0.87 | 42 uses│
│   ├─ 📝 Code Reviewer       │
│   │   v2 | ⭐ 0.92 | 38 uses│
│   └─ 📝 Data Analyzer       │
│       v1 | ⭐ 0.78 | 15 uses│
│                             │
│ 📁 feature/experiments (3)  │
│   └─ 📝 New Idea            │
│       v1 | ⭐ ? | 0 uses    │
│                             │
│ 📊 Analytics                │
│ 🏥 Health Check             │
│ 📦 Packages                 │
└─────────────────────────────┘
```

### Quick Execute Panel
```
┌────────────────────────────────────────────┐
│ Quick Execute                              │
├────────────────────────────────────────────┤
│ Prompt: [SQL Optimizer ▼]                  │
│                                            │
│ Variables:                                 │
│   query: ┌─────────────────────────────┐  │
│          │ SELECT * FROM users         │  │
│          │ WHERE active=1              │  │
│          └─────────────────────────────┘  │
│                                            │
│ Backend: [Ollama ▼] Model: [llama3.2 ▼]   │
│                                            │
│ [▶ Execute]  [💾 Save]  [📋 Copy]         │
│                                            │
│ ── Output ─────────────────────────────    │
│ ✓ Executed in 2.3s                        │
│                                            │
│ Optimization Suggestions:                 │
│ 1. Add index on `active` column           │
│ 2. Consider using `SELECT id, name`       │
│    instead of SELECT *                    │
│ ...                                        │
└────────────────────────────────────────────┘
```

### Analytics Dashboard
```
┌────────────────────────────────────────────┐
│ Analytics Dashboard                        │
├────────────────────────────────────────────┤
│                                            │
│ 📈 Execution Trend (Last 30 Days)         │
│    ╭─────────────────────────────╮        │
│  50│         ╭╮                  │        │
│    │       ╭─╯╰╮                 │        │
│  25│     ╭─╯   ╰─╮               │        │
│    │ ╭───╯       ╰───╮           │        │
│   0└─────────────────────────────┘        │
│                                            │
│ 🏆 Top Performing Prompts                 │
│  1. Code Reviewer    (0.92) 38 uses       │
│  2. SQL Optimizer    (0.87) 42 uses       │
│  3. Data Analyzer    (0.78) 15 uses       │
│                                            │
│ 💰 Cost Summary: $12.45 (this month)      │
│ ⚡ Avg Execution Time: 3.2s               │
│ ✓ Success Rate: 94.2%                     │
└────────────────────────────────────────────┘
```

---

## 📚 Documentation Plan

### README.md
- Screenshots of extension in action
- Quick start guide
- Feature overview
- Installation instructions
- Configuration options

### USAGE.md
- Detailed usage guide
- Command reference
- Keyboard shortcuts
- Tips and tricks

### DEVELOPMENT.md
- Setup development environment
- Architecture overview
- Contributing guidelines
- Testing guide

### Marketplace Description
- Compelling headline
- Feature highlights
- Screenshots/GIFs
- Links to docs

---

## 🚀 Go-to-Market Strategy

### Pre-Launch (Week 4)
- Beta testing with 10 users
- Create demo video (2-3 minutes)
- Write blog post announcing v1.2
- Prepare social media posts

### Launch (Week 5)
- Publish to VS Code Marketplace
- Announce on Twitter, Reddit, HN
- Post in VS Code extension communities
- Email existing Promptly users

### Post-Launch (Week 6+)
- Monitor feedback and issues
- Quick bug fixes if needed
- Gather feature requests
- Plan v1.3 improvements

---

## 💡 Future Enhancements (v1.3+)

### Short-Term
- Prompt templates library
- Collaborative editing (Live Share integration)
- Keyboard shortcuts customization
- Workspace-specific settings

### Medium-Term
- AI-powered prompt suggestions
- Prompt composition (combine prompts)
- Version control integration (GitLens-like)
- Remote prompt repositories

### Long-Term
- Team collaboration features
- Prompt marketplace integration
- Multi-language support
- Mobile companion app

---

## 📋 Open Questions

1. **Python Backend**: FastAPI server or subprocess? (Leaning FastAPI)
2. **Analytics Charts**: D3.js or Chart.js? (D3.js more powerful, Chart.js simpler)
3. **File Format**: Continue with `.promptly` or use `.md` with front-matter? (Keep `.promptly`)
4. **Marketplace Name**: "Promptly" or "Promptly Prompt Manager"? (Just "Promptly")
5. **Pricing**: Free or freemium with paid features? (Free for v1.2, evaluate later)

---

## ✅ Next Steps

1. **This Week**: Finalize plan, get feedback
2. **Next Week**: Start Week 1 development
3. **Week 2**: Continue development, daily standups
4. **Week 3**: Advanced features, integration testing
5. **Week 4**: Polish, documentation, publish

---

## 🎯 Success Criteria

**v1.2 is successful if**:
- ✅ Published to VS Code Marketplace
- ✅ All core features working (library, editor, execute, analytics)
- ✅ Week 2 smart features integrated
- ✅ 1000+ downloads in first month
- ✅ 4+ star rating
- ✅ Zero critical bugs

---

**Promptly v1.2 VS Code Extension: Bringing Prompts to the IDE** 🚀

**Timeline**: 4 weeks
**Effort**: Full-time development
**Impact**: Strategic market expansion

Let's build this! 🎊