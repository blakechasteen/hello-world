
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Confidence Trajectory Visualization Demo</title>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                margin: 40px;
                background: #f9fafb;
            }
            h1 {
                color: #111827;
                font-size: 24px;
                font-weight: 600;
                margin-bottom: 8px;
            }
            .subtitle {
                color: #6b7280;
                font-size: 14px;
                margin-bottom: 32px;
            }
            .section {
                background: #ffffff;
                border: 1px solid #e5e7eb;
                border-radius: 8px;
                padding: 24px;
                margin-bottom: 24px;
            }
            .section-title {
                font-size: 16px;
                font-weight: 600;
                color: #374151;
                margin-bottom: 16px;
            }
            .tufte-quote {
                border-left: 4px solid #3b82f6;
                padding-left: 16px;
                margin: 24px 0;
                font-style: italic;
                color: #6b7280;
            }
            .use-cases {
                background: #f0fdf4;
                border-left: 4px solid #10b981;
                padding: 16px;
                margin: 16px 0;
                border-radius: 4px;
            }
            .use-cases h3 {
                margin-top: 0;
                color: #065f46;
                font-size: 14px;
            }
            .use-cases ul {
                margin: 8px 0;
                padding-left: 20px;
                color: #374151;
                font-size: 13px;
                line-height: 1.6;
            }
            .api-example {
                background: #f3f4f6;
                padding: 12px;
                border-radius: 4px;
                font-size: 12px;
                font-family: monospace;
                overflow-x: auto;
                margin: 12px 0;
            }
        </style>
    </head>
    <body>
        <h1>Confidence Trajectory Visualization</h1>
        <div class="subtitle">
            Time series confidence tracking with anomaly detection - Tufte-style
        </div>

        <div class="tufte-quote">
            "Above all else show the data. The representation of numbers, as physically measured on the
            surface of the graphic itself, should be directly proportional to the quantities represented."
            <br><strong>— Edward Tufte</strong>
        </div>

        <div class="use-cases">
            <h3>Use Cases for Confidence Trajectories</h3>
            <ul>
                <li><strong>System Reliability Monitoring:</strong> Track confidence over time to identify degradation</li>
                <li><strong>Anomaly Detection:</strong> Automatically detect sudden drops, prolonged low periods</li>
                <li><strong>Cache Effectiveness:</strong> Visualize cache hit/miss patterns with confidence</li>
                <li><strong>User Session Analysis:</strong> See confidence evolution during user interactions</li>
                <li><strong>A/B Testing:</strong> Compare confidence trajectories between different configurations</li>
                <li><strong>Alert Triggers:</strong> Programmatically detect when to alert operators</li>
            </ul>
        </div>

        <div class="section">
            <div class="section-title">Example 1: Stable System Performance</div>
            <p style="color: #6b7280; font-size: 13px; margin-bottom: 16px;">
                Healthy system with consistent high confidence. Low variance, high cache hit rate (80%).
                No anomalies detected. This is ideal system behavior.
            </p>
            
        <div class="confidence-trajectory" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                                                    background: #ffffff; padding: 16px; border-radius: 4px;">
            
        <div class="trajectory-header" style="margin-bottom: 16px;">
            <div style="display: flex; justify-content: space-between; align-items: start;">
                <div>
                    <div style="font-size: 14px; font-weight: 600; color: #374151;">Stable System Performance</div>
                    <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">Low variance, high cache hit rate</div>
                </div>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Mean</div>
                        <div style="font-weight: 600; color: #374151;">0.91</div>
                    </div>
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Trend</div>
                        <div style="font-weight: 600; color: #6b7280;">→ 0.001</div>
                    </div>
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Reliability</div>
                        <div style="font-weight: 600; color: #374151;">0.80</div>
                    </div>
                </div>
            </div>
        </div>
        
            
        <svg width="600" height="200" style="display: block;">
            
            <!-- Confidence bands (mean ± std) -->
            <rect x="40" y="49.85857209056019" width="520" height="3.0828558188796222"
                  fill="#dbeafe" opacity="0.5"/>
            <line x1="40" y1="51.39999999999999" x2="560" y2="51.39999999999999"
                  stroke="#3b82f6" stroke-width="1" stroke-dasharray="4,4" opacity="0.5"/>
            
            
                    <rect x="37.0" y="46.599999999999994" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="94.77777777777777" y="49.0" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="152.55555555555554" y="47.8" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="268.1111111111111" y="46.599999999999994" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="325.8888888888889" y="49.0" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="383.6666666666667" y="47.8" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="499.22222222222223" y="49.0" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="557.0" y="46.599999999999994" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
            <path d="M 40.0,49.6 L 97.8,52.0 L 155.6,50.8 L 213.3,53.2 L 271.1,49.6 L 328.9,52.0 L 386.7,50.8 L 444.4,54.4 L 502.2,52.0 L 560.0,49.6" stroke="#3b82f6" stroke-width="2" fill="none"/>
            
            
        <!-- Axes -->
        <line x1="40" y1="160" x2="560" y2="160"
              stroke="#d1d5db" stroke-width="1"/>
        <line x1="40" y1="40" x2="40" y2="160"
              stroke="#d1d5db" stroke-width="1"/>

        <!-- Y-axis labels -->
        <text x="32" y="40" text-anchor="end" fill="#9ca3af" font-size="10">1.0</text>
        <text x="32" y="160" text-anchor="end" fill="#9ca3af" font-size="10">0.0</text>

        <!-- X-axis labels -->
        <text x="40" y="176" text-anchor="middle" fill="#9ca3af" font-size="10">0</text>
        <text x="560" y="176" text-anchor="middle" fill="#9ca3af" font-size="10">9</text>
        
        </svg>
        
            
        <div style="margin-top: 16px;">
            
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; font-size: 11px;">
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Std Dev</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">0.013</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Range</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">0.88 - 0.92</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Cache Hit Rate</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">80.0%</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Anomalies</div>
                <div style="font-weight: 600; color: #10b981; font-family: monospace;">0</div>
            </div>
        </div>
        
            
        </div>
        
        </div>
        
        </div>

        <div class="section">
            <div class="section-title">Example 2: System with Anomaly</div>
            <p style="color: #6b7280; font-size: 13px; margin-bottom: 16px;">
                System experiences sudden confidence drop at query 3. Anomaly detected automatically.
                Cache miss coincides with drop. System recovers quickly.
            </p>
            
        <div class="confidence-trajectory" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                                                    background: #ffffff; padding: 16px; border-radius: 4px;">
            
        <div class="trajectory-header" style="margin-bottom: 16px;">
            <div style="display: flex; justify-content: space-between; align-items: start;">
                <div>
                    <div style="font-size: 14px; font-weight: 600; color: #374151;">System with Anomaly</div>
                    <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">Sudden confidence drop at query 3</div>
                </div>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Mean</div>
                        <div style="font-weight: 600; color: #374151;">0.87</div>
                    </div>
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Trend</div>
                        <div style="font-weight: 600; color: #10b981;">↑ 0.004</div>
                    </div>
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Reliability</div>
                        <div style="font-weight: 600; color: #374151;">0.73</div>
                    </div>
                </div>
            </div>
        </div>
        
            
        <svg width="600" height="200" style="display: block;">
            
            <!-- Confidence bands (mean ± std) -->
            <rect x="40" y="46.49280911519065" width="520" height="17.974381769618674"
                  fill="#dbeafe" opacity="0.5"/>
            <line x1="40" y1="55.47999999999999" x2="560" y2="55.47999999999999"
                  stroke="#3b82f6" stroke-width="1" stroke-dasharray="4,4" opacity="0.5"/>
            
            
                    <rect x="37.0" y="46.599999999999994" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="94.77777777777777" y="49.0" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="152.55555555555554" y="50.2" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="325.8888888888889" y="51.400000000000006" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="383.6666666666667" y="49.0" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="441.44444444444446" y="50.2" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="499.22222222222223" y="47.8" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="557.0" y="49.0" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
            <path d="M 40.0,49.6 L 97.8,52.0 L 155.6,53.2 L 213.3,82.0 L 271.1,55.6 L 328.9,54.4 L 386.7,52.0 L 444.4,53.2 L 502.2,50.8 L 560.0,52.0" stroke="#3b82f6" stroke-width="2" fill="none"/>
            
                <circle cx="213.33333333333334" cy="82.0" r="6" fill="none" stroke="#ef4444" stroke-width="2"/>
                <circle cx="213.33333333333334" cy="82.0" r="3" fill="#ef4444"/>
                
            
        <!-- Axes -->
        <line x1="40" y1="160" x2="560" y2="160"
              stroke="#d1d5db" stroke-width="1"/>
        <line x1="40" y1="40" x2="40" y2="160"
              stroke="#d1d5db" stroke-width="1"/>

        <!-- Y-axis labels -->
        <text x="32" y="40" text-anchor="end" fill="#9ca3af" font-size="10">1.0</text>
        <text x="32" y="160" text-anchor="end" fill="#9ca3af" font-size="10">0.0</text>

        <!-- X-axis labels -->
        <text x="40" y="176" text-anchor="middle" fill="#9ca3af" font-size="10">0</text>
        <text x="560" y="176" text-anchor="middle" fill="#9ca3af" font-size="10">9</text>
        
        </svg>
        
            
        <div style="margin-top: 16px;">
            
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; font-size: 11px;">
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Std Dev</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">0.075</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Range</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">0.65 - 0.92</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Cache Hit Rate</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">80.0%</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Anomalies</div>
                <div style="font-weight: 600; color: #10b981; font-family: monospace;">0</div>
            </div>
        </div>
        
            
            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e7eb;">
                <div style="font-size: 12px; font-weight: 500; color: #374151; margin-bottom: 8px;">
                    Anomalies Detected (1)
                </div>
                <div style="display: flex; flex-direction: column; gap: 4px;">
                    
                <div style="display: flex; align-items: center; gap: 8px; padding: 6px; background: #f9fafb; border-radius: 3px;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #ef4444;"></div>
                    <div style="flex: 1;">
                        <div style="font-size: 11px; font-weight: 500; color: #374151;">Sudden Drop</div>
                        <div style="font-size: 10px; color: #6b7280;">Confidence dropped from 0.89 to 0.65 (+0.24)</div>
                    </div>
                    <div style="font-size: 10px; font-weight: 600; color: #ef4444;">0.48</div>
                </div>
                
                </div>
            </div>
            
        </div>
        
        </div>
        
        </div>

        <div class="section">
            <div class="section-title">Example 3: Degrading System</div>
            <p style="color: #6b7280; font-size: 13px; margin-bottom: 16px;">
                System showing clear negative trend. Prolonged low confidence detected.
                Cache effectiveness declining. Alert operators - investigation needed.
            </p>
            
        <div class="confidence-trajectory" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                                                    background: #ffffff; padding: 16px; border-radius: 4px;">
            
        <div class="trajectory-header" style="margin-bottom: 16px;">
            <div style="display: flex; justify-content: space-between; align-items: start;">
                <div>
                    <div style="font-size: 14px; font-weight: 600; color: #374151;">Degrading System</div>
                    <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">Negative trend, increasing cache misses</div>
                </div>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Mean</div>
                        <div style="font-weight: 600; color: #374151;">0.74</div>
                    </div>
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Trend</div>
                        <div style="font-weight: 600; color: #ef4444;">↓ 0.039</div>
                    </div>
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Reliability</div>
                        <div style="font-weight: 600; color: #374151;">0.59</div>
                    </div>
                </div>
            </div>
        </div>
        
            
        <svg width="600" height="200" style="display: block;">
            
            <!-- Confidence bands (mean ± std) -->
            <rect x="40" y="57.53500837989088" width="520" height="26.849983240218236"
                  fill="#dbeafe" opacity="0.5"/>
            <line x1="40" y1="70.96000000000001" x2="560" y2="70.96000000000001"
                  stroke="#3b82f6" stroke-width="1" stroke-dasharray="4,4" opacity="0.5"/>
            
            
                    <rect x="37.0" y="46.599999999999994" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="94.77777777777777" y="51.400000000000006" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
            <path d="M 40.0,49.6 L 97.8,54.4 L 155.6,59.2 L 213.3,64.0 L 271.1,68.8 L 328.9,73.6 L 386.7,78.4 L 444.4,83.2 L 502.2,88.0 L 560.0,90.4" stroke="#3b82f6" stroke-width="2" fill="none"/>
            
                <circle cx="155.55555555555554" cy="59.2" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="155.55555555555554" cy="59.2" r="3" fill="#6366f1"/>
                
                <circle cx="213.33333333333334" cy="64.0" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="213.33333333333334" cy="64.0" r="3" fill="#6366f1"/>
                
                <circle cx="271.1111111111111" cy="68.8" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="271.1111111111111" cy="68.8" r="3" fill="#6366f1"/>
                
                <circle cx="328.8888888888889" cy="73.60000000000001" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="328.8888888888889" cy="73.60000000000001" r="3" fill="#6366f1"/>
                
                <circle cx="386.6666666666667" cy="78.39999999999999" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="386.6666666666667" cy="78.39999999999999" r="3" fill="#6366f1"/>
                
                <circle cx="213.33333333333334" cy="64.0" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="213.33333333333334" cy="64.0" r="3" fill="#6366f1"/>
                
                <circle cx="271.1111111111111" cy="68.8" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="271.1111111111111" cy="68.8" r="3" fill="#6366f1"/>
                
                <circle cx="328.8888888888889" cy="73.60000000000001" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="328.8888888888889" cy="73.60000000000001" r="3" fill="#6366f1"/>
                
                <circle cx="386.6666666666667" cy="78.39999999999999" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="386.6666666666667" cy="78.39999999999999" r="3" fill="#6366f1"/>
                
                <circle cx="444.44444444444446" cy="83.2" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="444.44444444444446" cy="83.2" r="3" fill="#6366f1"/>
                
                <circle cx="271.1111111111111" cy="68.8" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="271.1111111111111" cy="68.8" r="3" fill="#6366f1"/>
                
                <circle cx="328.8888888888889" cy="73.60000000000001" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="328.8888888888889" cy="73.60000000000001" r="3" fill="#6366f1"/>
                
                <circle cx="386.6666666666667" cy="78.39999999999999" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="386.6666666666667" cy="78.39999999999999" r="3" fill="#6366f1"/>
                
                <circle cx="444.44444444444446" cy="83.2" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="444.44444444444446" cy="83.2" r="3" fill="#6366f1"/>
                
                <circle cx="502.22222222222223" cy="88.0" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="502.22222222222223" cy="88.0" r="3" fill="#6366f1"/>
                
                <circle cx="328.8888888888889" cy="73.60000000000001" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="328.8888888888889" cy="73.60000000000001" r="3" fill="#6366f1"/>
                
                <circle cx="386.6666666666667" cy="78.39999999999999" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="386.6666666666667" cy="78.39999999999999" r="3" fill="#6366f1"/>
                
                <circle cx="444.44444444444446" cy="83.2" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="444.44444444444446" cy="83.2" r="3" fill="#6366f1"/>
                
                <circle cx="502.22222222222223" cy="88.0" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="502.22222222222223" cy="88.0" r="3" fill="#6366f1"/>
                
                <circle cx="560.0" cy="90.4" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="560.0" cy="90.4" r="3" fill="#6366f1"/>
                
                <circle cx="155.55555555555554" cy="59.2" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="155.55555555555554" cy="59.2" r="3" fill="#6366f1"/>
                
                <circle cx="213.33333333333334" cy="64.0" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="213.33333333333334" cy="64.0" r="3" fill="#6366f1"/>
                
                <circle cx="271.1111111111111" cy="68.8" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="271.1111111111111" cy="68.8" r="3" fill="#6366f1"/>
                
                <circle cx="328.8888888888889" cy="73.60000000000001" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="328.8888888888889" cy="73.60000000000001" r="3" fill="#6366f1"/>
                
                <circle cx="155.55555555555554" cy="59.2" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="155.55555555555554" cy="59.2" r="3" fill="#6366f1"/>
                
                <circle cx="213.33333333333334" cy="64.0" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="213.33333333333334" cy="64.0" r="3" fill="#6366f1"/>
                
                <circle cx="271.1111111111111" cy="68.8" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="271.1111111111111" cy="68.8" r="3" fill="#6366f1"/>
                
                <circle cx="386.6666666666667" cy="78.39999999999999" r="6" fill="none" stroke="#f59e0b" stroke-width="2"/>
                <circle cx="386.6666666666667" cy="78.39999999999999" r="3" fill="#f59e0b"/>
                
                <circle cx="444.44444444444446" cy="83.2" r="6" fill="none" stroke="#f59e0b" stroke-width="2"/>
                <circle cx="444.44444444444446" cy="83.2" r="3" fill="#f59e0b"/>
                
                <circle cx="502.22222222222223" cy="88.0" r="6" fill="none" stroke="#f59e0b" stroke-width="2"/>
                <circle cx="502.22222222222223" cy="88.0" r="3" fill="#f59e0b"/>
                
                <circle cx="560.0" cy="90.4" r="6" fill="none" stroke="#f59e0b" stroke-width="2"/>
                <circle cx="560.0" cy="90.4" r="3" fill="#f59e0b"/>
                
            
        <!-- Axes -->
        <line x1="40" y1="160" x2="560" y2="160"
              stroke="#d1d5db" stroke-width="1"/>
        <line x1="40" y1="40" x2="40" y2="160"
              stroke="#d1d5db" stroke-width="1"/>

        <!-- Y-axis labels -->
        <text x="32" y="40" text-anchor="end" fill="#9ca3af" font-size="10">1.0</text>
        <text x="32" y="160" text-anchor="end" fill="#9ca3af" font-size="10">0.0</text>

        <!-- X-axis labels -->
        <text x="40" y="176" text-anchor="middle" fill="#9ca3af" font-size="10">0</text>
        <text x="560" y="176" text-anchor="middle" fill="#9ca3af" font-size="10">9</text>
        
        </svg>
        
            
        <div style="margin-top: 16px;">
            
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; font-size: 11px;">
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Std Dev</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">0.112</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Range</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">0.58 - 0.92</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Cache Hit Rate</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">20.0%</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Anomalies</div>
                <div style="font-weight: 600; color: #10b981; font-family: monospace;">0</div>
            </div>
        </div>
        
            
            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e7eb;">
                <div style="font-size: 12px; font-weight: 500; color: #374151; margin-bottom: 8px;">
                    Anomalies Detected (7)
                </div>
                <div style="display: flex; flex-direction: column; gap: 4px;">
                    
                <div style="display: flex; align-items: center; gap: 8px; padding: 6px; background: #f9fafb; border-radius: 3px;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #6366f1;"></div>
                    <div style="flex: 1;">
                        <div style="font-size: 11px; font-weight: 500; color: #374151;">Cache Miss Cluster</div>
                        <div style="font-size: 10px; color: #6b7280;">5/5 cache misses in window</div>
                    </div>
                    <div style="font-size: 10px; font-weight: 600; color: #6366f1;">1.00</div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 8px; padding: 6px; background: #f9fafb; border-radius: 3px;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #6366f1;"></div>
                    <div style="flex: 1;">
                        <div style="font-size: 11px; font-weight: 500; color: #374151;">Cache Miss Cluster</div>
                        <div style="font-size: 10px; color: #6b7280;">5/5 cache misses in window</div>
                    </div>
                    <div style="font-size: 10px; font-weight: 600; color: #6366f1;">1.00</div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 8px; padding: 6px; background: #f9fafb; border-radius: 3px;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #6366f1;"></div>
                    <div style="flex: 1;">
                        <div style="font-size: 11px; font-weight: 500; color: #374151;">Cache Miss Cluster</div>
                        <div style="font-size: 10px; color: #6b7280;">5/5 cache misses in window</div>
                    </div>
                    <div style="font-size: 10px; font-weight: 600; color: #6366f1;">1.00</div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 8px; padding: 6px; background: #f9fafb; border-radius: 3px;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #6366f1;"></div>
                    <div style="flex: 1;">
                        <div style="font-size: 11px; font-weight: 500; color: #374151;">Cache Miss Cluster</div>
                        <div style="font-size: 10px; color: #6b7280;">5/5 cache misses in window</div>
                    </div>
                    <div style="font-size: 10px; font-weight: 600; color: #6366f1;">1.00</div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 8px; padding: 6px; background: #f9fafb; border-radius: 3px;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #6366f1;"></div>
                    <div style="flex: 1;">
                        <div style="font-size: 11px; font-weight: 500; color: #374151;">Cache Miss Cluster</div>
                        <div style="font-size: 10px; color: #6b7280;">4/5 cache misses in window</div>
                    </div>
                    <div style="font-size: 10px; font-weight: 600; color: #6366f1;">0.80</div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 8px; padding: 6px; background: #f9fafb; border-radius: 3px;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #6366f1;"></div>
                    <div style="flex: 1;">
                        <div style="font-size: 11px; font-weight: 500; color: #374151;">Cache Miss Cluster</div>
                        <div style="font-size: 10px; color: #6b7280;">3/5 cache misses in window</div>
                    </div>
                    <div style="font-size: 10px; font-weight: 600; color: #6366f1;">0.60</div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 8px; padding: 6px; background: #f9fafb; border-radius: 3px;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #f59e0b;"></div>
                    <div style="flex: 1;">
                        <div style="font-size: 11px; font-weight: 500; color: #374151;">Prolonged Low</div>
                        <div style="font-size: 10px; color: #6b7280;">4 consecutive queries below 0.70</div>
                    </div>
                    <div style="font-size: 10px; font-weight: 600; color: #f59e0b;">0.14</div>
                </div>
                
                </div>
            </div>
            
        </div>
        
        </div>
        
        </div>

        <div class="section">
            <div class="section-title">Example 4: Recovering System</div>
            <p style="color: #6b7280; font-size: 13px; margin-bottom: 16px;">
                System recovering from issues. Positive trend visible. Cache warming up.
                Confidence improving over time. Recovery trajectory looks healthy.
            </p>
            
        <div class="confidence-trajectory" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                                                    background: #ffffff; padding: 16px; border-radius: 4px;">
            
        <div class="trajectory-header" style="margin-bottom: 16px;">
            <div style="display: flex; justify-content: space-between; align-items: start;">
                <div>
                    <div style="font-size: 14px; font-weight: 600; color: #374151;">Recovering System</div>
                    <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">Positive trend, cache warming up</div>
                </div>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Mean</div>
                        <div style="font-weight: 600; color: #374151;">0.81</div>
                    </div>
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Trend</div>
                        <div style="font-weight: 600; color: #10b981;">↑ 0.032</div>
                    </div>
                    <div>
                        <div style="color: #9ca3af; margin-bottom: 2px;">Reliability</div>
                        <div style="font-weight: 600; color: #374151;">0.66</div>
                    </div>
                </div>
            </div>
        </div>
        
            
        <svg width="600" height="200" style="display: block;">
            
            <!-- Confidence bands (mean ± std) -->
            <rect x="40" y="52.165410554897875" width="520" height="22.469178890204233"
                  fill="#dbeafe" opacity="0.5"/>
            <line x1="40" y1="63.39999999999999" x2="560" y2="63.39999999999999"
                  stroke="#3b82f6" stroke-width="1" stroke-dasharray="4,4" opacity="0.5"/>
            
            
                    <rect x="210.33333333333334" y="65.8" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="268.1111111111111" y="61.0" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="325.8888888888889" y="56.2" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="383.6666666666667" y="52.599999999999994" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="441.44444444444446" y="49.0" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="499.22222222222223" y="47.8" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
                    <rect x="557.0" y="46.599999999999994" width="6" height="6" fill="#10b981" opacity="0.6"/>
                    
            <path d="M 40.0,82.0 L 97.8,78.4 L 155.6,73.6 L 213.3,68.8 L 271.1,64.0 L 328.9,59.2 L 386.7,55.6 L 444.4,52.0 L 502.2,50.8 L 560.0,49.6" stroke="#3b82f6" stroke-width="2" fill="none"/>
            
                <circle cx="40.0" cy="82.0" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="40.0" cy="82.0" r="3" fill="#6366f1"/>
                
                <circle cx="97.77777777777777" cy="78.39999999999999" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="97.77777777777777" cy="78.39999999999999" r="3" fill="#6366f1"/>
                
                <circle cx="155.55555555555554" cy="73.60000000000001" r="6" fill="none" stroke="#6366f1" stroke-width="2"/>
                <circle cx="155.55555555555554" cy="73.60000000000001" r="3" fill="#6366f1"/>
                
            
        <!-- Axes -->
        <line x1="40" y1="160" x2="560" y2="160"
              stroke="#d1d5db" stroke-width="1"/>
        <line x1="40" y1="40" x2="40" y2="160"
              stroke="#d1d5db" stroke-width="1"/>

        <!-- Y-axis labels -->
        <text x="32" y="40" text-anchor="end" fill="#9ca3af" font-size="10">1.0</text>
        <text x="32" y="160" text-anchor="end" fill="#9ca3af" font-size="10">0.0</text>

        <!-- X-axis labels -->
        <text x="40" y="176" text-anchor="middle" fill="#9ca3af" font-size="10">0</text>
        <text x="560" y="176" text-anchor="middle" fill="#9ca3af" font-size="10">9</text>
        
        </svg>
        
            
        <div style="margin-top: 16px;">
            
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; font-size: 11px;">
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Std Dev</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">0.094</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Range</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">0.65 - 0.92</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Cache Hit Rate</div>
                <div style="font-weight: 600; color: #374151; font-family: monospace;">70.0%</div>
            </div>
            <div>
                <div style="color: #9ca3af; margin-bottom: 2px;">Anomalies</div>
                <div style="font-weight: 600; color: #10b981; font-family: monospace;">0</div>
            </div>
        </div>
        
            
            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e7eb;">
                <div style="font-size: 12px; font-weight: 500; color: #374151; margin-bottom: 8px;">
                    Anomalies Detected (1)
                </div>
                <div style="display: flex; flex-direction: column; gap: 4px;">
                    
                <div style="display: flex; align-items: center; gap: 8px; padding: 6px; background: #f9fafb; border-radius: 3px;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #6366f1;"></div>
                    <div style="flex: 1;">
                        <div style="font-size: 11px; font-weight: 500; color: #374151;">Cache Miss Cluster</div>
                        <div style="font-size: 10px; color: #6b7280;">3/5 cache misses in window</div>
                    </div>
                    <div style="font-size: 10px; font-weight: 600; color: #6366f1;">0.60</div>
                </div>
                
                </div>
            </div>
            
        </div>
        
        </div>
        
        </div>

        <div class="section">
            <div class="section-title">Programmatic API Usage</div>
            <p style="color: #6b7280; font-size: 13px; margin-bottom: 12px;">
                The confidence trajectory visualization provides a simple API for automated tool calling:
            </p>
            <div class="api-example">
from HoloLoom.visualization.confidence_trajectory import render_confidence_trajectory

# Simple usage - just confidence scores
confidences = [0.92, 0.88, 0.65, 0.87, 0.91]
html = render_confidence_trajectory(confidences)

# With cache markers
cached = [True, True, False, False, True]
html = render_confidence_trajectory(confidences, cached=cached)

# Complete usage
query_texts = ["Query 1", "Query 2", "Query 3", "Query 4", "Query 5"]
html = render_confidence_trajectory(
    confidences,
    cached=cached,
    query_texts=query_texts,
    title='Session Analysis',
    subtitle='Last 24 hours',
    detect_anomalies=True
)

# Integration with HoloLoom
results = []
for query in queries:
    spacetime = await orchestrator.weave(query)
    results.append(spacetime)

# Extract confidence scores
confidences = [s.confidence for s in results]
cached = [s.metadata.get('cache_hit', False) for s in results]

# Render trajectory
html = render_confidence_trajectory(confidences, cached=cached)
            </div>
        </div>

        <div class="section">
            <div class="section-title">Anomaly Types Detected</div>
            <ul style="color: #374151; font-size: 13px; line-height: 1.8;">
                <li><strong>Sudden Drop:</strong> Confidence drops >0.2 in single step (red markers)</li>
                <li><strong>Prolonged Low:</strong> Confidence below threshold for >3 consecutive queries (amber markers)</li>
                <li><strong>High Variance:</strong> Standard deviation >0.15 in rolling window (amber markers)</li>
                <li><strong>Cache Miss Cluster:</strong> 3+ cache misses in rolling window (indigo markers)</li>
            </ul>
        </div>

        <div class="section">
            <div class="section-title">Design Principles Applied</div>
            <ul style="color: #374151; font-size: 13px; line-height: 1.8;">
                <li><strong>Meaning First:</strong> Anomalies highlighted immediately with colored markers</li>
                <li><strong>Maximize data-ink ratio:</strong> No grid lines, minimal axes</li>
                <li><strong>Layering:</strong> Line, bands, cache markers, anomaly markers convey multiple dimensions</li>
                <li><strong>Data density:</strong> Confidence + cache + anomalies + trends in compact space</li>
                <li><strong>Direct labeling:</strong> Statistics shown inline, no separate legend</li>
                <li><strong>Statistical context:</strong> Mean ± std bands show expected variance range</li>
                <li><strong>Zero dependencies:</strong> Pure HTML/CSS/SVG, no external libraries</li>
            </ul>
        </div>

        <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #e5e7eb;
                    text-align: center; color: #9ca3af; font-size: 12px;">
            Generated with HoloLoom Visualizer | Confidence Trajectory Visualization
        </div>
    </body>
    </html>
    